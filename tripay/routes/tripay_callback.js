const a0u=a0d;(function(a,b){const s=a0d,c=a();while(!![]){try{const d=parseInt(s(0x78))/0x1+-parseInt(s(0x91))/0x2+parseInt(s(0xa2))/0x3*(parseInt(s(0xa1))/0x4)+parseInt(s(0x8a))/0x5+-parseInt(s(0x8d))/0x6+-parseInt(s(0x77))/0x7*(-parseInt(s(0x99))/0x8)+-parseInt(s(0x76))/0x9;if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a0c,0x53d25));function a0d(a,b){const c=a0c();return a0d=function(d,e){d=d-0x73;let f=c[d];if(a0d['wYxANn']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='',p=n+g;for(let q=0x0,r,s,t=0x0;s=l['charAt'](t++);~s&&(r=q%0x4?r*0x40+s:s,q++%0x4)?n+=p['charCodeAt'](t+0xa)-0xa!==0x0?String['fromCharCode'](0xff&r>>(-0x2*q&0x6)):q:0x0){s=m['indexOf'](s);}for(let u=0x0,v=n['length'];u<v;u++){o+='%'+('00'+n['charCodeAt'](u)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a0d['bOPUtc']=g,a=arguments,a0d['wYxANn']=!![];}const h=c[0x0],i=d+h,j=a[i];if(!j){const k=function(l){this['WtiRIx']=l,this['JLAnQr']=[0x1,0x0,0x0],this['rdAJlH']=function(){return'newState';},this['aPSbNq']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['iejrPh']='[\x27|\x22].+[\x27|\x22];?\x20*}';};k['prototype']['jTKiDV']=function(){const l=new RegExp(this['aPSbNq']+this['iejrPh']),m=l['test'](this['rdAJlH']['toString']())?--this['JLAnQr'][0x1]:--this['JLAnQr'][0x0];return this['bFxfFe'](m);},k['prototype']['bFxfFe']=function(l){if(!Boolean(~l))return l;return this['XxhjEH'](this['WtiRIx']);},k['prototype']['XxhjEH']=function(l){for(let m=0x0,n=this['JLAnQr']['length'];m<n;m++){this['JLAnQr']['push'](Math['round'](Math['random']())),n=this['JLAnQr']['length'];}return l(this['JLAnQr'][0x0]);},new k(a0d)['jTKiDV'](),f=a0d['bOPUtc'](f),a[i]=f;}else f=j;return f;},a0d(a,b);}const a0b=(function(){let a=!![];return function(b,c){const d=a?function(){if(c){const e=c['apply'](b,arguments);return c=null,e;}}:function(){};return a=![],d;};}()),a0a=a0b(this,function(){const t=a0d;return a0a[t(0x8f)]()[t(0x94)]('(((.+)+)+)+$')['toString']()[t(0x9d)](a0a)['search']('(((.+)+)+)+$');});a0a();const express=require('express'),crypto=require(a0u(0xa0)),fs=require('fs'),path=require('path'),axios=require(a0u(0x95)),mysql=require(a0u(0x85));require('dotenv')[a0u(0x97)]();function a0c(){const x=['mJeWotm2nLH0zgrdva','zxHLy3v0zq','Dg9tDhjPBMC','BgvUz3rO','mJKWmZK4yNrXtfHW','Ahr0Chm6lY9HCgKUDgvSzwDYyw0UB3jNl2jVDa','su5trvjuieLove8GDg9Rzw5FBg9NAw4GkhrVA2vUlcbPzf90zwXLz3jHBsWGC3vKywHFzgLWywTHAsWGzgLIDwf0x3bHzgeSigTHzgfSDwfYC2fFCgfKysWGBgv2zwWSignVAw4PcIaGicaGicaGicbwquXvrvmGkd8Sid8SidaSid8Sid8Sid8Sid8P','C2vHCMnO','yxHPB3m','yxbWzw5KrMLSzvn5BMm','y29UzMLN','Cg9ZDa','mZKYs2TICuH6','vevmruDsqu1Fve9lru4','su5trvjuieLove8GBgLZDf9RB250CM9SicHPzf90zwXLz3jHBsWGAwrFDgvSzwDYyw1FCgvTAwXPAYWGBMfTyv9HA3vUlcb1C2vYBMfTzv9HA3vUkqOGicaGicaGicaGicaGifzbtfvfuYaOpYWGpYWGpYWGpYK','pc9IpGOGicaGicdIJ7mGqMvYBgfRDtOGmZaGAgfYAqOGicaGicaGia','y29UC3rYDwn0B3i','BMfTyv9Szw5NA2fW','rejFue9sva','y3j5ChrV','mZK3mKHstuzltq','mZi3BgHSrhHK','AwrFDgvSzwDYyw0','rejFueftuW','C2HHmJu2','Ec1JywXSyMfJAY1ZAwDUyxr1CMu','l3nLBMrnzxnZywDL','ndqXntuYnNfRtLfWwq','ndq3mJnywhH6tNq','ndq3mJa4rwT3CfnH','w09lxsa','BwvZC2fNzq','vKLqiePbu0flwq','vvbeqvrfihrYyw5ZywTZAv90CMLWyxKGu0vuihn0yxr1CYa9id8SihvWzgf0zwrFyxqGpsbot1COksbxsevsrsbYzwzLCMvUy2uGpsa/','w0LovKfmsurDia','C2vUza','4PYfihrYAxbHEv9JywXSyMfJAY5QCYbHA3rPzIbKyw4GCM91DguGl2nHBgXIywnRihrLCNbHC2fUzW','4P2mienHBgXIywnRigvYCM9YoG','rejFvvnfuG','zw52','z2v0vgLTzq','ChjVzhvRx2XHyMvS','BxLZCwWYl3bYB21PC2u','cUkCHsa8yJ5bA3vUieTVBNrYB2WGqMvYAgfZAwWGrgLIDwf0pc9IpGOk8j+rPca','A29UDhjVBa','Dg9ju09tDhjPBMC','Agv4','mJmXmtaWnuL2uuj0rG','zxjYB3i','twvTyMvYiePbu0flwq'];a0c=function(){return x;};return a0c();}const router=express['Router'](),LOG_FILE=path['join'](__dirname,'../logs/tripay.log'),dbConfig={'host':process['env']['DB_HOST'],'user':process['env'][a0u(0x81)],'password':process['env'][a0u(0xa4)],'database':process[a0u(0x82)]['DB_NAME'],'port':process['env'][a0u(0x9f)]||0xcea};async function kirimPesanTelegram(a,b){const v=a0u,c=process['env'][v(0x9a)];if(!c)return;try{await axios['post'](v(0x92)+c+v(0x75),{'chat_id':a,'text':b,'parse_mode':'HTML'});}catch(d){console[v(0x8b)]('Telegram\x20error:',d[v(0x7a)]);}}router[a0u(0x98)]('/callback',async(a,b)=>{const w=a0u,c=a['headers'][w(0x74)],d=JSON['stringify'](a['body']),e=crypto['createHmac'](w(0x73),process[w(0x82)]['TRIPAY_PRIVATE_KEY'])['update'](d)['digest']('hex');if(c!==e)return fs['appendFileSync'](LOG_FILE,w(0x7d)+new Date()['toISOString']()+'\x20=>\x20'+d+'\x0a'),b['status'](0x193)[w(0x7e)]('Invalid\x20signature');const {reference:f,status:g}=a['body'];fs['appendFileSync'](LOG_FILE,w(0x79)+new Date()[w(0x88)]()+'\x20|\x20REF='+f+'\x20STATUS='+g+'\x0a');try{const h=await mysql['createConnection'](dbConfig);await h['execute'](w(0x7c),[g,f]);if(g==='PAID'){const [[i]]=await h[w(0x8e)]('SELECT\x20*\x20FROM\x20transaksi_tripay\x20WHERE\x20reference\x20=\x20?',[f]);if(!i)return b[w(0x7e)]('Transaksi\x20tidak\x20ditemukan');if(i['tipe']==='token'){const j=crypto['randomBytes'](0x20)['toString'](w(0x89)),k=new Date(),l=new Date(k[w(0x83)]()+0x1e*0x18*0x3c*0x3c*0x3e8),m={'Token\x20Member\x20(10\x20coin)':w(0x8c),'Token\x20JASEB\x20(25\x20coin)':'JASEB\x20JASAKY','Token\x20VIP\x20(30\x20coin)':w(0x7b)},n=m[i[w(0x84)]]||'Member\x20JASAKY';await h['execute'](w(0x93),[j,null,k,l,n,0x0]),await kirimPesanTelegram(i[w(0xa3)],'\x0a\x20\x20\x20\x20\x20\x20‚úÖ\x20<b>Token\x20Berhasil\x20Dibeli</b>\x0a\x0a\x20\x20\x20\x20\x20\x20üéüÔ∏è\x20<code>'+j+'</code>\x0a\x0a\x20\x20\x20\x20\x20\x20üè∑Ô∏è\x20Level:\x20<b>'+n+w(0x9c));}else{if(i['tipe']===w(0x87)){const [[o]]=await h['execute']('SELECT\x20*\x20FROM\x20pending_kontrol\x20WHERE\x20reference\x20=\x20?',[f]);if(o){await h['execute']('INSERT\x20INTO\x20kontrol_akun\x20(id_telegram,\x20username,\x20password,\x20nama_lengkap,\x20status_aktif)\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x201)',[o[w(0xa3)],o['username'],o['password'],o[w(0x9e)]]);const p=JSON['parse'](o['target_json']||'[]');for(const q of p){await h['execute'](w(0x9b),[q['id'],o['id_telegram'],q['nama'],q['username']]);}await h[w(0x8e)]('DELETE\x20FROM\x20pending_kontrol\x20WHERE\x20reference\x20=\x20?',[f]),await kirimPesanTelegram(i[w(0xa3)],w(0x86)+o['nama_lengkap']+'\x0aüîê\x20'+o['password']+'\x0aJumlah\x20target:\x20'+p[w(0x90)]+'\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20');}}}}await h['end'](),b['send']('OK');}catch(r){console['error'](w(0x80),r['message']),fs[w(0x96)](LOG_FILE,'[ERROR]\x20'+new Date()['toISOString']()+'\x20=>\x20'+r['message']+'\x0a'),b['status'](0x1f4)['send']('Internal\x20Server\x20Error');}}),module['exports']=router,console['log'](a0u(0x7f));