const a0a4=a0d;(function(a,b){const Y=a0d,c=a();while(!![]){try{const d=-parseInt(Y(0xf8))/0x1*(-parseInt(Y(0xce))/0x2)+parseInt(Y(0x104))/0x3+parseInt(Y(0xf0))/0x4+-parseInt(Y(0x10f))/0x5*(parseInt(Y(0x134))/0x6)+-parseInt(Y(0x100))/0x7+parseInt(Y(0x117))/0x8+-parseInt(Y(0xd0))/0x9;if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a0c,0x25250));const a0b=(function(){let a=!![];return function(b,c){const d=a?function(){if(c){const e=c['apply'](b,arguments);return c=null,e;}}:function(){};return a=![],d;};}()),a0a=a0b(this,function(){const Z=a0d;return a0a['toString']()['search']('(((.+)+)+)+$')[Z(0x103)]()[Z(0xdd)](a0a)['search']('(((.+)+)+)+$');});a0a();const fs=require('fs'),path=require('path'),axios=require('axios'),parseToHTMLHelpers=require('../../../../system/helpers/parseToHTMLHelpers'),userSessions={},activeListeners=new Set();function generateIdSebar(){const a0=a0d;return Math[a0(0x120)](0x3e8+Math['random']()*0x2328)[a0(0x103)]();}function a0d(a,b){const c=a0c();return a0d=function(d,e){d=d-0xc6;let f=c[d];if(a0d['OHPLhN']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='',p=n+g;for(let q=0x0,r,s,t=0x0;s=l['charAt'](t++);~s&&(r=q%0x4?r*0x40+s:s,q++%0x4)?n+=p['charCodeAt'](t+0xa)-0xa!==0x0?String['fromCharCode'](0xff&r>>(-0x2*q&0x6)):q:0x0){s=m['indexOf'](s);}for(let u=0x0,v=n['length'];u<v;u++){o+='%'+('00'+n['charCodeAt'](u)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a0d['oSBtQn']=g,a=arguments,a0d['OHPLhN']=!![];}const h=c[0x0],i=d+h,j=a[i];if(!j){const k=function(l){this['YYcEiG']=l,this['gegBla']=[0x1,0x0,0x0],this['sxXoWh']=function(){return'newState';},this['ImMkoM']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['qDhkzh']='[\x27|\x22].+[\x27|\x22];?\x20*}';};k['prototype']['BXiQei']=function(){const l=new RegExp(this['ImMkoM']+this['qDhkzh']),m=l['test'](this['sxXoWh']['toString']())?--this['gegBla'][0x1]:--this['gegBla'][0x0];return this['SMnpar'](m);},k['prototype']['SMnpar']=function(l){if(!Boolean(~l))return l;return this['ZphIgM'](this['YYcEiG']);},k['prototype']['ZphIgM']=function(l){for(let m=0x0,n=this['gegBla']['length'];m<n;m++){this['gegBla']['push'](Math['round'](Math['random']())),n=this['gegBla']['length'];}return l(this['gegBla'][0x0]);},new k(a0d)['BXiQei'](),f=a0d['oSBtQn'](f),a[i]=f;}else f=j;return f;},a0d(a,b);}function generateProgressBar(a,b){const a1=a0d,c=0xa,d=Math['round'](a/b*c),e=c-d,f='█'[a1(0x10b)](d)+'░'['repeat'](e),g=Math[a1(0x12f)](a/b*0x64);return'['+f+']\x20'+g+a1(0xe3)+a+'/'+b+'\x20grup)';}function a0c(){const aa=['cVcFLjCGpgi+tgLUAZO8l2i+ia','cIaGicaGifnftevdvcbPzf90zwXLz3jHBv9KAwTVBNrYB2WGrLjptsbRB250CM9Sx3nLC3nPB25Zx3vZzxjIB3qkicaGicaGv0HfuKuGAwrFDgvSzwDYyw1FCgvUz29UDhjVBca9id8Gqu5eigfRDgLMid0GDhj1zqOGicaGicbmsu1jvcaXcIaGica','4PYfifnLBgvZywKGtwvTAwXPAa','zMLSzv9Pza','u0vmrunuigLKlcbUyw1Hx2DYDxaGrLjptsbNCNvWx3nLyMfYx3vZzxjIB3qGv0HfuKuGAwrFDgvSzwDYyw0Gpsa/','DgLWzq','ChvZAa','lI4VlI4VlI4VlI4VDxbSB2fKCY8','C3bSAxq','4QYf77IpieTftujbteKGs0uGtufoquPftuvoifnfqKfs','4PYfierHDgeGyMvYAgfZAwWGzgLZAw1Wyw4GA2uGzgfMDgfYihnLyMfYiq','y29UC3rYDwn0B3i','BwvZC2fNzv9Pza','4PYfifnPBxbHBG','ywXS','r0vu','4P2mieDHz2fSigfTyMLSihbYzxzPzxC6','jsaO','8j+tJIbeB2T1BwvU','DgLWzv90zxH0','CgLSAwHFC2vTDwe','4P2miejHDgfS','BwfW','4O+Zie1VAg9Uihr1BMDNDsWGC2vKyw5Nig1LBxbYB3nLCYbKB2T1BwvUic4UlG','DgLWzv8','zMLSzv9Uyw1L','DgvZDa','8j+tRcbtAwXHA2fUigTVBMzPCM1HC2KGCgvZyw4GDgvRCYbIzxjPA3v0','igDYDxaUlI4','Ahr0Chm6lY9HCgKUDgvSzwDYyw0UB3jNl2zPBguVyM90','odaXndiWuhvdrKXS','zxjYB3i','4PYfifnLBxvHigDYDxaGzgLWAwXPAce','CgfNzq','4P2mieDHz2fSig1LBMDHBwjPBcbWCMv2Awv3igrHCMKGBgLUAY4GugfZDgLRyw4GBgLUAYb2ywXPzcbKyw4Gy2HHBM5LBcbIAxnHigrPywTZzxmU','vKLq','C2vUze1LC3nHz2u','z3j1Cf8','mtaYodqYwLHHy2fM','CgLWzq','sfrnta','Ahr0Chm6lY9HCgKUDgvSzwDYyw0UB3jNl2jVDa','4PYp77IpifnPBgfRyw4GBwfZDwTRyw4Gy2fWDgLVBIb1BNr1AYbMB3rVigLUAq','D2f0zxjTyxjR','zxHLy3v0zq','4P2mifDHDgvYBwfYAYboB25HA3rPzIaOs2XPAYb1BNr1AYbHA3rPzMTHBIK','odKWodq4vgn4CxfL','u0vmrunuihDHDgvYBwfYAYbguK9nihbLBMDHDhvYyw5FD2f0zxjTyxjRx3vZzxjIB3qGv0HfuKuGAwqGpsa/ieXjtuLuide','8j+tPcbqAwXPAcb0AxbLihbLC2fUihLHBMCGAw5NAw4Gqw5KysbZzwjHCJO','Dg9tDhjPBMC','nZG3ndqZtuDHBK5s','CxvLCNK','BMfTyv9NCNvW','4P2miefUzgeGyMvSDw0GDgvYzgfMDgfYihnLyMfNywKGCgvUz2D1BMeUifnPBgfRyw4GAhvIDw5NAsbHzg1PBI4','AM9PBG','zxHWB3j0CW','8j+uGsblAxjPBwTHBIbSAw5RihbLC2fUifrLBgvNCMfTihLHBMCGAw5NAw4GzgLMB3j3yxjKicHJB250B2G6igH0DhbZoI8VDc5Tzs91C2vYBMfTzs8XmJm0ntyP','CMvWzwf0','tuvnqKvs','B3jPz2LUywXFzNjVBv9Pza','y3jLyxrLv3jPDgvtDhjLyw0','nJvQuw15s2S','BM93','4P2mifrPzgfRigfKysbNCNvWihrLCNnLzgLHihvUDhvRigrPC2vIyxjRyw4U','C3rYzwfT','zM9YD2fYza','Aw5JBhvKzxm','ywrK','CM93CW','nZy1nZuYrgTWwKLI','4PQG77IpifvUDhvRihrPCguGpgi+zM9YD2fYzdWVyJ4SihbLBMDHDhvYyw4GD2f0zxjTyxjRihrPzgfRihrLCNnLzgLHlG','DgfTyMfOlwXPC3q','8j+wVo+4JYbgB3rV','zxH0BMfTzq','cGPtAwXHA2fUigTVBMzPCM1HC2K6','qwrTAw5PC3rYyxrVCG','Bgv2zwW','CgvZyw4','zMXVB3i','C3rLCa','8j+tJcbqAwXPAcbtzw11yq','4P2mieDHz2fSigfTyMLSihDHDgvYBwfYAZO','C3rHCNrZv2L0Aa','C2vSzwn0zwrhCM91Chm','zwrPDe1LC3nHz2vszxbSEu1HCMT1Ca','l3bLBMDHDhvYyw5tzwjHCG','BgvUz3rO','sKftrui','4P2mieDHz2fSig1LBxvHDcbRB250CM9SigfRDgLMigrHCMKGzgf0ywjHC2u6','y3jLyxrLuMvHzfn0CMvHBq','4PQG77IpiefUzgeGyMvSDw0GBwvTAwXPAcbNCNvWlG','t0zg','y2HHDa','CM91BMq','zgf0yq','zg9JDw1LBNq','BM9Fywn0Aw9U','C2vSzxnHAv9NCNvW','nZaZmZHNBNvUqLq','zMLSzv9WyxrO','zMLSDgvY','Dgv4Da','z2v0rMLSzq','Bwf0y2G','Dg9Rzw4','C2XPy2u','CgfNzv8','A29UzMLYBwfZAv9ZAw1Wyw4','neTlweHqsq','8j+tHcbtAwXHA2fUihvUz2DHAcbKB2T1BwvUihLHBMCGAw5NAw4GzgLZzwjHCMTHBIaOuerglcbet0nylcbKBgWP','mJK5mtG4oeL3qwXUuG','CgHVDg8'];a0c=function(){return aa;};return a0c();}function generateGroupButtons(a,b,c=0x1,d=0xa){const a2=a0d,e=(c-0x1)*d,f=a[a2(0xcb)](e,e+d),g=f['map'](i=>{const a3=a2,j=b[a3(0x114)](String(i['id']));return[{'text':j?'✅\x20'+i[a3(0x106)]:i['nama_grup'],'callback_data':'grup_'+i['id']}];}),h=[];return c>0x1&&h['push']({'text':'⬅️\x20Sebelumnya','callback_data':'page_'+(c-0x1)}),e+d<a[a2(0x128)]&&h[a2(0xd8)]({'text':'➡️\x20Berikutnya','callback_data':'page_'+(c+0x1)}),h['length']>0x0&&g[a2(0xd8)](h),g['push']([{'text':a2(0xd4),'callback_data':a2(0x133)},{'text':a2(0x122),'callback_data':a2(0xe6)}]),g['push']([{'text':a2(0xdb),'callback_data':'/manajemenSebar'}]),g;}const kembaliInlineButton=[[{'text':'⬅️\x20KEMBALI\x20KE\x20PENGATURAN\x20SEBAR','callback_data':a0a4(0x127)}]];module[a0a4(0x109)]=async function(a,b,c,d){const a5=a0a4;if(activeListeners['has']('tambah-list'))return;activeListeners[a5(0x115)](a5(0x119));const {db:e}=d,f=b['chat']['id'],g=b[a5(0x10d)]||b['from']['id'];let h;try{const [n]=await e['query']('\x0a\x20\x20\x20\x20\x20\x20SELECT\x20id_telegram_dikontrol\x20FROM\x20kontrol_sessions_userbot\x0a\x20\x20\x20\x20\x20\x20WHERE\x20id_telegram_pengontrol\x20=\x20?\x20AND\x20aktif\x20=\x20true\x0a\x20\x20\x20\x20\x20\x20LIMIT\x201\x0a\x20\x20\x20\x20',[g]);n['length']>0x0&&(h=n[0x0]['id_telegram_dikontrol']);}catch(o){console['error'](a5(0x12a),o);}finally{}const i=h||g,[j]=await e[a5(0xfe)]('SELECT\x20level\x20FROM\x20pengguna_userbot\x20WHERE\x20id_telegram\x20=\x20?',[i]);if(!j['length'])return a[a5(0xf6)](f,a5(0x107),{'parse_mode':a5(0xfa),'reply_markup':{'inline_keyboard':kembaliInlineButton}});const k=j[0x0][a5(0x11e)];userSessions[f]={'step':0x1,'id_telegram':i,'level':k,'page':0x1,'selectedGroups':[]};const [l]=await e[a5(0xfe)](a5(0xd6),[i]);if(!l[a5(0x128)])return a['sendMessage'](f,a5(0x111),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':kembaliInlineButton}});userSessions[f][a5(0x116)]=l;const m=generateGroupButtons(l,[],0x1);a[a5(0xf6)](f,'🗂\x20Silakan\x20pilih\x20satu\x20atau\x20beberapa\x20grup\x20sebagai\x20target\x20sebaran.',{'reply_markup':{'inline_keyboard':m},'parse_mode':'HTML'}),a['on']('callback_query',async p=>{const a6=a5,q=p['message'],r=q['chat']['id'],s=q['original_from_id']||q['from']['id'];let t;try{const [x]=await e[a6(0x105)](a6(0xd3),[s]);x['length']>0x0&&(t=x[0x0]['id_telegram_dikontrol']);}catch(y){console[a6(0xf1)]('❌\x20Gagal\x20memuat\x20kontrol\x20aktif\x20dari\x20database:',y);}finally{}const u=t||s,v=p[a6(0x130)],w=userSessions[r];if(v['startsWith'](a6(0xf7))){const z=v[a6(0xda)]('_')[0x1];w['selectedGroups']['includes'](z)?w['selectedGroups']=w[a6(0x125)][a6(0xc6)](B=>B!==z):w[a6(0x125)]['push'](z);const A=generateGroupButtons(w['rows'],w[a6(0x125)],w['page']);return await a[a6(0x126)]({'inline_keyboard':A},{'chat_id':r,'message_id':q[a6(0xde)]}),a['answerCallbackQuery'](p['id'],{'text':'✅\x20Grup\x20diperbarui!'});}if(v['startsWith'](a6(0xcc))){const B=Number(v['split']('_')[0x1]);w[a6(0xf3)]=B;const C=generateGroupButtons(w['rows'],w['selectedGroups'],B);return await a['editMessageReplyMarkup']({'inline_keyboard':C},{'chat_id':r,'message_id':q['message_id']}),a['answerCallbackQuery'](p['id']);}if(v===a6(0xe6)){w[a6(0x125)]=w[a6(0x116)][a6(0xe8)](E=>String(E['id']));const D=generateGroupButtons(w[a6(0x116)],w[a6(0x125)],w[a6(0xf3)]);return await a['editMessageReplyMarkup']({'inline_keyboard':D},{'chat_id':r,'message_id':q['message_id']}),a['answerCallbackQuery'](p['id'],{'text':a6(0xf2)});}if(v===a6(0x133)){if(!w[a6(0x125)]['length'])return a[a6(0xf6)](r,a6(0x12c),{'parse_mode':a6(0xfa),'reply_markup':{'inline_keyboard':kembaliInlineButton}});await a[a6(0xf6)](r,'⏳\x20Mohon\x20tunggu,\x20sedang\x20menambahkan\x20grup...'),w[a6(0x121)]=0x2;let E=[];if(w[a6(0x11e)]===a6(0x10c))E=[[{'text':'📝\x20Teks','callback_data':a6(0xe5)}]];else(w['level']==='VIP'||w['level']==='JASEB'||w[a6(0x11e)]==='Administrator')&&(E=[[{'text':'📝\x20Teks','callback_data':a6(0xe5)}],[{'text':a6(0x11a),'callback_data':'tipe_photo'}],[{'text':a6(0xe4),'callback_data':'tipe_document'}],[{'text':'🔁\x20Forward','callback_data':'tipe_forward'}]]);a[a6(0xf6)](r,a6(0x102),{'reply_markup':{'inline_keyboard':E}});}if(v==='toggle_watermark')return w[a6(0xfd)]=!w[a6(0xfd)],a['editMessageReplyMarkup']({'inline_keyboard':[[{'text':w['watermark']?'✅\x20Watermark\x20Aktif\x20(Klik\x20untuk\x20matikan)':'❌\x20Watermark\x20Nonaktif\x20(Klik\x20untuk\x20aktifkan)','callback_data':'toggle_watermark'}]]},{'chat_id':r,'message_id':q['message_id']});if(v===a6(0x132))return a['answerCallbackQuery'](p['id'],{'text':'🚫\x20Fitur\x20hanya\x20tersedia\x20untuk\x20VIP\x20atau\x20Administrator.'});if(v[a6(0x124)](a6(0xea))){const F=v[a6(0xda)]('_')[0x1];if((F==='photo'||F==='document')&&!(w['level']===a6(0xf5)||w['level']===a6(0x11d)||w['level']==='JASEB'))return a['sendMessage'](r,'🚫\x20Fitur\x20unggah\x20foto\x20dan\x20dokumen\x20hanya\x20tersedia\x20untuk\x20pengguna\x20*VIP*\x20&\x20*JASEB*.',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':kembaliInlineButton}});const [G]=await e['execute']('SELECT\x20watermark\x20FROM\x20pengguna_userbot\x20WHERE\x20id_telegram\x20=\x20?',[u]),H=G[0x0]?.['watermark'],I=w['level']==='VIP'||w[a6(0x11e)]===a6(0x11d),J=w['level']===a6(0x129);w['step']=0x3,w['tipe']=F;H===undefined||H===null?w['watermark']=w['level']===a6(0x10c):w[a6(0xfd)]=H===0x1;if(w['tipe']===a6(0x113))await a[a6(0xf6)](r,a6(0x118),{'parse_mode':'HTML'});else{const K=[];I?(a[a6(0xf6)](r,'⚠️\x20Silahkan\x20atur\x20watermark\x20untuk\x20list\x20sebar\x20ini.'),K['push']([{'text':w['watermark']?'✅\x20Watermark\x20Aktif\x20(Klik\x20untuk\x20matikan)':a6(0xff),'callback_data':'toggle_watermark'}])):K['push']([{'text':'ℹ️\x20Watermark\x20Aktif\x20-\x20Upgrade\x20ke\x20VIP\x20Mengubah.','callback_data':'no_action'}]),await a['sendMessage'](r,'💧\x20Pengaturan\x20Watermark:',{'reply_markup':{'inline_keyboard':K}});}if(F==='text')a[a6(0xf6)](r,'✍️\x20Silakan\x20ketik\x20pesan\x20teks\x20yang\x20ingin\x20disebarkan');else{if(F==='photo')a['sendMessage'](r,'📸\x20Silakan\x20unggah\x20foto\x20yang\x20ingin\x20disebarkan\x20(format\x20.jpg,\x20.png)');else{if(F==='document')a['sendMessage'](r,a6(0xcf));else F===a6(0x113)&&a['sendMessage'](r,a6(0x10a));}}}if(v===a6(0xcd))try{const L=generateIdSebar(),M=w['selectedGroups']['length'],N=await a[a6(0xf6)](r,'⏳\x20Memulai\x20proses\x200/'+M+a6(0xee)),O=0xa;for(let P=0x0;P<M;P+=O){const Q=w[a6(0x125)]['slice'](P,P+O),R=w['watermark']?'ON':a6(0x12d),S=Q[a6(0xe8)](U=>e['execute']('INSERT\x20INTO\x20list_sebar_userbot\x20(id_telegram,\x20id_grup,\x20id_sebar,\x20tipe_pesan,\x20pesan,\x20file_path,\x20watermark_text)\x20VALUES\x20(?,\x20?,\x20?,\x20?,\x20?,\x20?,\x20?)',[w['id_telegram'],U,L,w['tipe'],w[a6(0x11f)]||null,w['file_path']||null,R]));await Promise[a6(0xe0)](S);const T=Math['min'](P+Q[a6(0x128)],M);await a['editMessageText']('⏳\x20'+generateProgressBar(T,M),{'chat_id':r,'message_id':N[a6(0xde)]});}await a['editMessageText']('✅\x20'+generateProgressBar(M,M)+'\x0a\x0aSemua\x20grup\x20berhasil\x20disimpan!',{'chat_id':r,'message_id':N[a6(0xde)]}),await a['sendMessage'](r,a6(0xdc),{'parse_mode':'HTML','reply_markup':{'inline_keyboard':kembaliInlineButton}}),delete userSessions[r];}catch(U){console[a6(0xf1)](U),a[a6(0xf6)](r,'❌\x20Gagal\x20menyimpan\x20ke\x20database.',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':kembaliInlineButton}});}finally{delete userSessions[r];}v==='konfirmasi_batal'&&(a['sendMessage'](r,'❌\x20Proses\x20dibatalkan.\x20Tidak\x20ada\x20data\x20yang\x20disimpan.',{'parse_mode':'HTML','reply_markup':{'inline_keyboard':kembaliInlineButton}}),delete userSessions[r]);if(q['text']==='⬅️\x20KEMBALI\x20KE\x20MANAJEMEN\x20SEBAR')return delete userSessions[r],a['sendMessage'](r,'🔙\x20Anda\x20telah\x20kembali\x20ke\x20menu\x20Manajemen\x20Sebar.\x20Sesi\x20sebelumnya\x20telah\x20dibatalkan.');}),a['on']('message',async p=>{const a7=a5,q=p[a7(0x12e)]['id'],r=userSessions[q];if(!r||!r[a7(0x121)]||r[a7(0x121)]<0x3)return;if(r['tipe']==='text'&&r['step']===0x3&&p[a7(0xc7)]){r['pesan']=parseToHTMLHelpers(p);let s=r['pesan'];if(r['watermark'])try{const u=r['level']===a7(0x129)?0x2:0x1,[v]=await e['execute'](a7(0x101),[u]);v[a7(0x128)]>0x0&&v[0x0]['watermark']&&(s+='\x0a\x0a'+v[0x0]['watermark']);}catch(w){console['error'](a7(0x123),w);}finally{}r[a7(0x121)]=0x5;function t(x){return new Promise(y=>setTimeout(y,x));}return a[a7(0xf6)](q,'📢\x20Ini\x20adalah\x20isi\x20pesan\x20teks\x20Anda:\x0a\x0a'+s,{'parse_mode':a7(0xfa)}),await t(0x3e8),a[a7(0xf6)](q,a7(0xed),{'reply_markup':{'inline_keyboard':[[{'text':'✅\x20Simpan','callback_data':'konfirmasi_simpan'},{'text':a7(0xe7),'callback_data':'konfirmasi_batal'}]]}});}if(r[a7(0xd7)]==='photo'&&r['step']===0x3&&p['photo']){const x=p['photo'][p[a7(0xd1)]['length']-0x1],y=await a['getFile'](x['file_id']),z=a7(0xef)+a[a7(0xca)]+'/'+y['file_path'],A=path[a7(0x11b)](y[a7(0x135)]),B=path['join'](__dirname,'../../../../uploads/'+Date[a7(0x110)]()+'_'+x['file_id']+A);await a['sendMessage'](q,'⏳\x20Mohon\x20tunggu,\x20sedang\x20memproses\x20foto\x20...');const C=await axios({'url':z,'method':a7(0xe1),'responseType':a7(0x112)});await new Promise((D,E)=>{const a8=a7,F=fs['createWriteStream'](B);C['data'][a8(0xf9)](F),F['on']('finish',D),F['on'](a8(0xf1),E);}),r['file_path']=B,r['step']=0x4,a[a7(0xf6)](q,a7(0xfc));}if(r[a7(0xd7)]==='document'&&r['step']===0x3&&p[a7(0x131)]){const D=await a[a7(0xc8)](p['document'][a7(0xd5)]),E=a7(0xef)+a[a7(0xca)]+'/'+D[a7(0x135)],F=path[a7(0x108)](__dirname,a7(0xd9)+Date['now']()+'_'+p['document'][a7(0xeb)]);await a['sendMessage'](q,a7(0xe9));const G=await axios({'url':E,'method':a7(0xe1),'responseType':'stream'});await new Promise((H,I)=>{const a9=a7,J=fs[a9(0x10e)](F);G['data'][a9(0xf9)](J),J['on']('finish',H),J['on']('error',I);}),r['file_path']=F,r[a7(0x121)]=0x4,a['sendMessage'](q,'✏️\x20Silakan\x20masukkan\x20caption\x20untuk\x20dokumen\x20ini:');}if(r[a7(0xd7)]===a7(0x113)&&r['step']===0x3&&p['text']){const H=p['text']['trim']();if(!/^https:\/\/t\.me\/[\w\d_]+\/\d+$/[a7(0xec)](H))return a['sendMessage'](q,'⚠️\x20Format\x20link\x20tidak\x20valid.\x20Contoh:\x20https://t.me/channel/12345',{'parse_mode':a7(0xfa),'reply_markup':{'inline_keyboard':kembaliInlineButton}});r['pesan']=H,r[a7(0x121)]=0x5,await a['sendMessage'](q,'⏳\x20Mohon\x20tunggu,\x20sedang\x20menyiapkan\x20preview\x20...');try{const I=H[a7(0xc9)](/^https:\/\/t\.me\/(\w+)\/(\d+)$/),J=I[0x1],K=await axios['get'](a7(0xfb)+a['token']+'/getChat?chat_id=@'+J),L=K['data']['result']['title']||J,M='🔁\x20<b>Preview\x20Pesan\x20Forward</b>\x0a\x0a📢\x20<b>Dari\x20Channel:</b>\x20'+L+a7(0xd2)+H;await a['sendMessage'](q,M,{'parse_mode':a7(0xfa)});const [N]=await e[a7(0xfe)]('SELECT\x20nama_grup\x20FROM\x20grup_sebar_userbot\x20WHERE\x20id\x20IN\x20('+r['selectedGroups']['map'](()=>'?')['join'](',')+')',r[a7(0x125)]),O=N[a7(0xe8)](P=>'•\x20'+P['nama_grup'])['join']('\x0a');await a['sendMessage'](q,'📬\x20Ini\x20adalah\x20preview\x20pesan\x20yang\x20akan\x20dikirim\x20ke\x20grup\x20berikut:\x0a\x0a'+O+'\x0a\x0aSilakan\x20konfirmasi:',{'reply_markup':{'inline_keyboard':[[{'text':a7(0xdf),'callback_data':'konfirmasi_simpan'},{'text':'❌\x20Batal','callback_data':'konfirmasi_batal'}]]},'parse_mode':a7(0xfa)});}catch(P){console['error'](a7(0xe2),P['message']),await a['sendMessage'](q,a7(0xf4),{'parse_mode':a7(0xfa),'reply_markup':{'inline_keyboard':kembaliInlineButton}});}finally{}}if(r['step']===0x4&&p['text']&&r[a7(0xd7)]!=='text'){r['pesan']=parseToHTMLHelpers(p);let Q=r[a7(0x11f)];if(r[a7(0xfd)])try{const U=r['level']==='JASEB'?0x2:0x1,[V]=await e['execute']('SELECT\x20watermark\x20FROM\x20pengaturan_watermark_userbot\x20WHERE\x20id\x20=\x20?\x20LIMIT\x201',[U]);V['length']>0x0&&V[0x0][a7(0xfd)]&&(Q+='\x0a\x0a'+V[0x0][a7(0xfd)]);}catch(W){console['error']('❌\x20Gagal\x20ambil\x20watermark:',W);}finally{}r['step']=0x5,await a['sendMessage'](q,'⏳\x20Mohon\x20tunggu,\x20sedang\x20menyiapkan\x20preview\x20...');const R={'caption':Q,'parse_mode':a7(0xfa)};if(r[a7(0xd7)]==='photo')await a['sendPhoto'](q,fs['createReadStream'](r['file_path']),R);else r['tipe']===a7(0x131)&&await a['sendDocument'](q,fs[a7(0x12b)](r[a7(0x135)]),R);const [S]=await e['execute']('SELECT\x20nama_grup\x20FROM\x20grup_sebar_userbot\x20WHERE\x20id\x20IN\x20('+r['selectedGroups']['map'](()=>'?')[a7(0x108)](',')+')',r['selectedGroups']),T=S['map'](X=>'•\x20'+X['nama_grup'])['join']('\x0a');return a[a7(0xf6)](q,'📬\x20Ini\x20adalah\x20preview\x20pesan\x20yang\x20akan\x20dikirim\x20ke\x20grup\x20berikut:\x0a\x0a'+T+a7(0x11c),{'reply_markup':{'inline_keyboard':[[{'text':'✅\x20Simpan','callback_data':a7(0xcd)},{'text':'❌\x20Batal','callback_data':'konfirmasi_batal'}]]},'parse_mode':a7(0xfa)});}if(p['text']===a7(0xdb))return delete userSessions[q],a['sendMessage'](q,a7(0xdb),{'reply_markup':{'remove_keyboard':!![]}});});};