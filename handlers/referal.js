const a0K=a0d;(function(a,b){const D=a0d,c=a();while(!![]){try{const d=parseInt(D(0x9d))/0x1+-parseInt(D(0xb8))/0x2+parseInt(D(0xb7))/0x3*(parseInt(D(0xc5))/0x4)+parseInt(D(0xa7))/0x5*(parseInt(D(0xb5))/0x6)+parseInt(D(0xaf))/0x7+-parseInt(D(0xaa))/0x8+-parseInt(D(0xb4))/0x9;if(d===b)break;else c['push'](c['shift']());}catch(e){c['push'](c['shift']());}}}(a0c,0xb07a5));const a0b=(function(){let a=!![];return function(b,c){const d=a?function(){if(c){const e=c['apply'](b,arguments);return c=null,e;}}:function(){};return a=![],d;};}()),a0a=a0b(this,function(){const E=a0d;return a0a['toString']()['search']('(((.+)+)+)+$')['toString']()[E(0xbf)](a0a)['search']('(((.+)+)+)+$');});a0a();const moment=require('moment'),kembaliButton={'reply_markup':{'inline_keyboard':[[{'text':'‚¨ÖÔ∏è\x20Kembali','callback_data':'/start'}]]}};async function referalHandler(a,b,c,d){const F=a0d,{db:e,getDataUserbot:f}=d,g=await f(),h=!!b['message'],i=h?b[F(0xcd)]:b,j=b['from']['id'],k=b['from']['username']||'',l=i['chat']['id'];let m;try{const [o]=await e['query']('SELECT\x20id_telegram_dikontrol\x20FROM\x20kontrol_sessions_userbot\x20WHERE\x20id_telegram_pengontrol\x20=\x20?\x20AND\x20aktif\x20=\x20true\x20LIMIT\x201',[j]);if(o['length']>0x0)m=o[0x0]['id_telegram_dikontrol'];}catch(p){console['error']('‚ùå\x20Gagal\x20muat\x20kontrol\x20aktif:',p);}const n=m||j;if(h&&b[F(0xc7)]==='ambil_coin'){try{const [[q]]=await e['execute'](F(0xce),[n]),[[r]]=await e[F(0xcf)]('SELECT\x20saldo_coin\x20FROM\x20pengguna_userbot\x20WHERE\x20id_telegram\x20=\x20?',[n]),s=q?.['jumlah_coin']||0x0;if(!r){await a['sendMessage'](n,'üîí\x20Akun\x20kamu\x20belum\x20terdaftar.\x0aNamun\x20coin\x20dari\x20referral\x20telah\x20disimpan.\x0a\x0a'+('üì¶\x20Coin\x20disimpan:\x20<b>'+s+F(0xa9))+'‚ÑπÔ∏è\x20Gunakan\x20coin\x20di\x20üõí\x20<b>TOKO</b>\x20üõí\x20untuk\x20membeli\x20lisensi\x20/\x20fitur.',{'parse_mode':F(0xb1),...kembaliButton}),await a['answerCallbackQuery'](b['id']);return;}if(s>0x0){const t=(r['saldo_coin']||0x0)+s;await e['execute']('UPDATE\x20pengguna_userbot\x20SET\x20saldo_coin\x20=\x20?\x20WHERE\x20id_telegram\x20=\x20?',[t,n]),await e['execute'](F(0xca),[n]),await a['sendMessage'](n,'üéâ\x20Kamu\x20telah\x20mengambil\x20<b>'+s+'</b>\x20coin\x20dari\x20referral.\x0a'+(F(0xc4)+t+'</b>\x20coin'),{'parse_mode':'HTML',...kembaliButton});}else await a[F(0xc0)](n,'‚ö†Ô∏è\x20Kamu\x20tidak\x20memiliki\x20coin\x20referral\x20untuk\x20diambil.',kembaliButton);await a['answerCallbackQuery'](b['id']);return;}catch(u){console[F(0xb0)](u),await a[F(0xc0)](n,F(0xbb),kembaliButton);}await a[F(0xa2)](b['id']);return;}try{await tampilkanLeaderboard(a,l,e);const [v]=await e['execute']('SELECT\x20*\x20FROM\x20referal_userbot\x20WHERE\x20id_telegram\x20=\x20?',[n]);let w=v[0x0];if(!w){const B=generateReferralCode();await e[F(0xcf)](F(0x9f),[n,k,B]),w={'kode_referal':B,'jumlah_referal':0x0,'jumlah_coin':0x0,'created_at':new Date()};}const x=moment(w['created_at'])[F(0xa3)]('DD\x20MMMM\x20YYYY,\x20HH:mm'),y=await buildPenggunaanCoin(d),z=g[F(0xb9)],A='üîó\x20<b>Link\x20Referral\x20Anda:</b>\x0a'+('<a\x20href=\x22https://t.me/'+z+'?start='+w['kode_referal']+F(0x9c)+z+'?start='+w[F(0xc2)]+F(0xa1))+(F(0xa6)+w['jumlah_referal']+'\x0a')+(F(0xc1)+w['jumlah_coin']+'\x0a')+(F(0xb3)+x+'\x20WIB\x0a\x0a')+'üìå\x20<b>Keterangan:</b>\x0a'+F(0xcc)+('ü™ô\x20<b>Penggunaan\x20Coin:</b>\x0a<pre>'+y+'</pre>\x0a')+'‚ÑπÔ∏è\x20Gunakan\x20coin\x20di\x20üõí\x20<b>TOKO</b>\x20üõí\x20untuk\x20membeli\x20lisensi\x20/\x20fitur.';await a['sendMessage'](l,A,{'parse_mode':F(0xb1),'reply_markup':{'inline_keyboard':[[{'text':'üí∞\x20Ambil\x20Coin','callback_data':'ambil_coin'}],[{'text':'‚¨ÖÔ∏è\x20Kembali','callback_data':F(0xad)}]]}});}catch(C){console['error']('‚ùå\x20Error\x20referral:',C),await a[F(0xc0)](l,'‚ùå\x20Gagal\x20memproses\x20referral.',kembaliButton);}}function generateReferralCode(a=0x6){const G=a0d,b='ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';let c='';for(let d=0x0;d<a;d++){c+=b[G(0xa4)](Math[G(0xb6)](Math['random']()*b[G(0xc9)]));}return c;}async function tampilkanLeaderboard(a,b,c){const H=a0d,[d]=await c[H(0xcf)](H(0xc8));if(d[H(0xc9)]===0x0){await a[H(0xc0)](b,H(0xbd),{'parse_mode':H(0xb1),'reply_markup':kembaliButton[H(0xac)]});return;}const e=new Date()['toLocaleString'](H(0xa0),{'dateStyle':H(0x9e),'timeStyle':'short'});let f=H(0xae)+e+'\x20WIB\x0a\x0a';d[H(0xbe)]((g,h)=>{const I=H,j=(''+(g['username']||''))['trim']();f+=h+0x1+I(0xbc)+(j||'Tamu\x20'+g[I(0xcb)])+I(0xba)+g[I(0xd0)]+I(0xb2);}),await a['sendMessage'](b,f,{'parse_mode':'HTML'});}async function buildPenggunaanCoin(a){const J=a0d,{getDataUserbot:b}=a,c=await b(),{lisensiPaket:lisensiPaket='-',hargaMember:hargaMember=0x0,hargaJaseb:hargaJaseb=0x0,hargaVIP:hargaVIP=0x0,hargaSewaAdmin:hargaSewaAdmin=0x0,hargaLifetimeAdmin:hargaLifetimeAdmin=0x0,hargaKontrolAkun:hargaKontrolAkun=0x0,hargaSlotKontrol:hargaSlotKontrol=0x0}=c;let d='-\x20'+hargaMember+'\x20Coin\x20=\x201\x20Bulan\x20MEMBER\x0a'+('-\x20'+hargaJaseb+J(0xa5))+('-\x20'+hargaVIP+'\x20Coin\x20=\x201\x20Bulan\x20VIP\x0a');if(lisensiPaket[J(0xa8)](J(0xab)))d+='-\x20'+hargaKontrolAkun+'\x20Coin\x20=\x201\x20Kontrol\x20Akun\x0a';if(lisensiPaket['includes']('VVIP'))d+='-\x20'+hargaSewaAdmin+'\x20Coin\x20=\x201\x20Bulan\x20SEWA\x20ADMIN\x20+\x2010\x20Slot\x20Akun\x0a'+('-\x20'+hargaLifetimeAdmin+J(0xc3))+('-\x20'+hargaSlotKontrol+'\x20Coin\x20per\x201\x20slot.\x0a');return d;}function a0d(a,b){const c=a0c();return a0d=function(d,e){d=d-0x9c;let f=c[d];if(a0d['nzyxwp']===undefined){var g=function(l){const m='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let n='',o='',p=n+g;for(let q=0x0,r,s,t=0x0;s=l['charAt'](t++);~s&&(r=q%0x4?r*0x40+s:s,q++%0x4)?n+=p['charCodeAt'](t+0xa)-0xa!==0x0?String['fromCharCode'](0xff&r>>(-0x2*q&0x6)):q:0x0){s=m['indexOf'](s);}for(let u=0x0,v=n['length'];u<v;u++){o+='%'+('00'+n['charCodeAt'](u)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(o);};a0d['sQyNks']=g,a=arguments,a0d['nzyxwp']=!![];}const h=c[0x0],i=d+h,j=a[i];if(!j){const k=function(l){this['uIAJCq']=l,this['aSFZoj']=[0x1,0x0,0x0],this['yTFJaF']=function(){return'newState';},this['XQoiBg']='\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*',this['BgGptF']='[\x27|\x22].+[\x27|\x22];?\x20*}';};k['prototype']['WamBSY']=function(){const l=new RegExp(this['XQoiBg']+this['BgGptF']),m=l['test'](this['yTFJaF']['toString']())?--this['aSFZoj'][0x1]:--this['aSFZoj'][0x0];return this['AnUAzh'](m);},k['prototype']['AnUAzh']=function(l){if(!Boolean(~l))return l;return this['xSTRfD'](this['uIAJCq']);},k['prototype']['xSTRfD']=function(l){for(let m=0x0,n=this['aSFZoj']['length'];m<n;m++){this['aSFZoj']['push'](Math['round'](Math['random']())),n=this['aSFZoj']['length'];}return l(this['aSFZoj'][0x0]);},new k(a0d)['WamBSY'](),f=a0d['sQyNks'](f),a[i]=f;}else f=j;return f;},a0d(a,b);}referalHandler[a0K(0xc6)]=async(a,b,c,d)=>{await referalHandler(a,b,c,d);},module['exports']=referalHandler;function a0c(){const L=['l3n0yxj0','8j+pHIa8yJ5mzwfKzxjIB2fYzcbszwzLCNjHBdWVyJ4G8j+pHGRWN5ofia','ntKYmtmXngPpDNLSuq','zxjYB3i','sfrnta','pc9IpIbYzwzLCNjHBaO','8j+tHIa8yJ5uzxjKywz0yxiGu2vQywS6pc9IpIa','nZq4ote2mvzIqwzNta','mZKYnZyWnMHzsK1Nyq','zMXVB3i','mJi2mtu1v3DRu1bf','nZy2ndmWwLPTwMr1','DxnLCM5HBwvcB3q','ic0G','4P2mifrLCMPHzgKGA2vZywXHAgfUihnHyxqGBwvUz2fTyMLSignVAw4U','lIa8yJ4','8j+pHIa8yJ5mzwfKzxjIB2fYzcbszwzLCNjHBcblB3nVBMC8l2i+ipcFJ4y','zM9YrwfJAa','y29UC3rYDwn0B3i','C2vUze1LC3nHz2u','8j+sSca8yJ5uB3rHBcbdB2LUoJWVyJ4G','A29Kzv9YzwzLCMfS','ienVAw4GpsbmAwzLDgLTzsbtrvDbiefetuLoicSGmJaGu2XVDcbbA3vUcG','8j+sScbtywXKBYbZzwTHCMfUzZOGpgi+','ngHPBuflAq','B25dywXSyMfJA1f1zxj5','zgf0yq','cGKju0vmrunuihiUAwrFDgvSzwDYyw0SihiUDxnLCM5HBwuSihiUA29Kzv9YzwzLCMfSlcbYlMP1BwXHAf9YzwzLCMfSlcbWlM5HBwfFzgvWyw4SihaUBMfTyv9IzwXHA2fUzWOjcuzst00GCMvMzxjHBf91C2vYyM90ihikcqLmruzuiePpsu4GCgvUz2D1BMfFDxnLCMjVDcbWie9oihiUAwrFDgvSzwDYyw0GpsbWlMLKx3rLBgvNCMfTcGKjt1jerviGqLKGCI5QDw1SywHFCMvMzxjHBcbervndcGKjteLnsvqGmtakcq','BgvUz3rO','vvbeqvrfihjLzMvYywXFDxnLCMjVDcbtrvqGANvTBgfOx2nVAw4GpsaWifDirvjfigLKx3rLBgvNCMfTid0GpW','AwrFDgvSzwDYyw0','u2v0AwfWigTSAwSGu1rbuLqGzgfYAsbSAw5RigTHBxuGywTHBIbTzw1IzxjPA2fUideGy29PBI4kcG','BwvZC2fNzq','u0vmrunuigP1BwXHAf9JB2LUiezst00GCMvMzxjHBf91C2vYyM90ifDirvjfigLKx3rLBgvNCMfTid0GpW','zxHLy3v0zq','ANvTBgfOx3jLzMvYywW','iJ5ODhrWCZOVl3qUBwuV','ntqWnty3DvLvtKvX','zNvSBa','su5trvjuieLove8GCMvMzxjHBf91C2vYyM90icHPzf90zwXLz3jHBsWGDxnLCM5HBwuSigTVzgvFCMvMzxjHBcWGy3jLyxrLzf9HDcKGvKfmvuvticG/lca/lca/lcbot1COksK','AwqTsuq','pc9HpGOk','yw5ZD2vYq2fSBgjHy2TrDwvYEq','zM9YBwf0','y2HHCKf0','ienVAw4GpsaXiej1BgfUiePbu0vccG','8j+rPsa8yJ5kDw1SywGGuMvMzxjYywW6pc9IpIa','nwrSBfbIEa','Aw5JBhvKzxm','ignVAw48l2i+cGO','mtqYnJa2nerrtKLdDa','vKLq','CMvWBhLFBwfYA3vW'];a0c=function(){return L;};return a0c();}